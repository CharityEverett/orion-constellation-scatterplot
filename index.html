<!DOCTYPE html>
<html>
<head>
    <title>Orion Constellation Magnitude vs Color Hertzsprung-Russell</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
</head>
<body>
    <a-scene renderer="precision: medium">
        <a-entity light="type: ambient; color: #FFF; intensity: 0.2"></a-entity>
        <a-entity light="type: directional; color: #FFF; intensity: 0.8" position="-1 1 0"></a-entity>

        <a-entity id="starfield"></a-entity>
        
        <a-sky color="#000000"></a-sky>
        
        <a-entity position="0 1.6 0">
            <a-camera look-controls wasd-controls>
                <a-cursor
                    id="cursor"
                    material="color: white; shader: flat"
                    position="0 0 -1"
                    geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                    raycaster="objects: .clickable">
                </a-cursor>
            </a-camera>
        </a-entity>
    </a-scene>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const starfield = document.getElementById('starfield');
        
        function getColorFromIndex(colorIndex) {
            if (colorIndex < 0) return '#88CCFF';
            if (colorIndex < 0.5) return '#FFFFFF';
            if (colorIndex < 1.0) return '#FFFF00';
            if (colorIndex < 1.5) return '#FF8000';
            return '#FF0000';
        }

        fetch('https://dieghernan.github.io/celestial_data/data/stars.6.geojson')
            .then(response => response.json())
            .then(data => {
                const stars = data.features.filter(star => 
                    star.properties.mag !== undefined && star.properties['B-V'] !== undefined
                );

                const magMin = Math.min(...stars.map(s => s.properties.mag));
                const magMax = Math.max(...stars.map(s => s.properties.mag));
                const colorMin = Math.min(...stars.map(s => s.properties['B-V']));
                const colorMax = Math.max(...stars.map(s => s.properties['B-V']));

                stars.forEach(star => {
                    const sphere = document.createElement('a-sphere');
                    
                    const magnitude = star.properties.mag;
                    const colorIndex = star.properties['B-V'];

                    // Normalize positions to fit in our view
                    const x = ((colorIndex - colorMin) / (colorMax - colorMin) * 10) - 5;
                    const y = ((magnitude - magMin) / (magMax - magMin) * -10) + 5; // Invert Y axis
                    const z = -5; // Fixed distance in front of the camera

                    sphere.setAttribute('position', `${x} ${y} ${z}`);
                    
                    // Calculate star size based on magnitude (brighter stars are larger)
                    const starSize = Math.max(0.05, 0.2 - magnitude * 0.02);
                    sphere.setAttribute('radius', starSize);
                    
                    const starColor = getColorFromIndex(colorIndex);
                    
                    sphere.setAttribute('material', {
                        shader: 'flat',
                        color: starColor,
                        emissive: starColor,
                        emissiveIntensity: 1,
                        opacity: 0.9
                    });
                    
                    sphere.setAttribute('class', 'clickable');
                    sphere.setAttribute('title', star.properties.name || 'Unnamed star');

                    sphere.addEventListener('mouseenter', function () {
                        this.setAttribute('scale', '1.2 1.2 1.2');
                    });
                    sphere.addEventListener('mouseleave', function () {
                        this.setAttribute('scale', '1 1 1');
                    });
                    
                    starfield.appendChild(sphere);
                });
            })
            .catch(error => console.error('Error:', error));
    });
    </script>
</body>
</html>
