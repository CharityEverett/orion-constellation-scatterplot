<!DOCTYPE html>
<html>
<head>
    <title>Orion Star Cluster Hertsprung-Russell Scatterplot</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
</head>
<body>
    <a-scene renderer="precision: medium">
        <!-- Lighting -->
        <a-entity light="type: ambient; color: #FFF; intensity: 0.8"></a-entity>
        <a-entity light="type: directional; color: #FFF; intensity: 1" position="-1 1 0"></a-entity>

        <!-- Reference sphere -->
        <a-sphere position="0 0 -5" 
                  radius="1" 
                  color="#FFFFFF"
                  material="shader: flat; opacity: 0.8"
                  class="clickable">
        </a-sphere>

        <!-- Stars container -->
        <a-entity id="starfield"></a-entity>
        
 <!-- Skybox -->
        <a-sky src="https://cdn.glitch.global/5cfc02c2-e08f-4e29-9383-05c3fa57335f/skybox_equirectangular.png?v=1732135394692"></a-sky>
        
        <!-- Camera rig -->
        <a-entity position="0 1.6 0">
            <a-camera look-controls wasd-controls>
                <a-cursor
                    id="cursor"
                    material="color: white; shader: flat"
                    position="0 0 -1"
                    geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                    raycaster="objects: .clickable">
                </a-cursor>
            </a-camera>
        </a-entity>
    </a-scene>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
    const starfield = document.getElementById('starfield');
    const scaleFactor = 0.05;

    fetch('https://dieghernan.github.io/celestial_data/data/stars.6.geojson')
        .then(response => response.json())
        .then(data => {
            const stars = data.features
                .filter(star => star.properties.mag < 5)
                .slice(0, 200);

            stars.forEach(star => {
                const sphere = document.createElement('a-sphere');
                
                // Assuming temperature, luminosity, and radius are available in star properties
                const temperature = star.properties.temperature || 5000; // Default value if not available
                const luminosity = star.properties.luminosity || 1; // Default value if not available
                const radius = star.properties.radius || 1; // Default value if not available

                // Map temperature to x-axis (inverted), luminosity to y-axis, and radius to z-axis
                const x = -temperature * scaleFactor;
                const y = Math.log10(luminosity) * scaleFactor;
                const z = radius * scaleFactor;

                sphere.setAttribute('position', `${x} ${y} ${z}`);
                sphere.setAttribute('radius', '0.1');
                sphere.setAttribute('color', '#FFFFFF');
                sphere.setAttribute('material', {
                    shader: 'flat',
                    opacity: 0.8
                });
                sphere.setAttribute('class', 'clickable');

                // Add star name label (if available)
                if (star.properties.name) {
                    const text = document.createElement('a-text');
                    text.setAttribute('value', star.properties.name);
                    text.setAttribute('align', 'center');
                    text.setAttribute('position', '0 0.5 0');
                    text.setAttribute('scale', '0.5 0.5 0.5');
                    text.setAttribute('visible', false);
                    sphere.appendChild(text);

                    sphere.addEventListener('mouseenter', () => {
                        text.setAttribute('visible', true);
                    });
                    sphere.addEventListener('mouseleave', () => {
                        text.setAttribute('visible', false);
                    });
                }

                starfield.appendChild(sphere);
            });
        })
        .catch(error => console.error('Error:', error));
});
                        
                        starfield.appendChild(sphere);
                    });
                })
                .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>
